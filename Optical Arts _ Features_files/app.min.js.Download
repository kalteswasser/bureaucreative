!function(e){function t(){b=new LazyLoad({elements_selector:".lazy",threshold:300})}function o(){e(document).unbind("mouseenter"),e(document).unbind("mouseleave"),e("a.archive-link").unbind("mouseenter"),e("a.archive-link").unbind("mouseleave"),e("a.list-link").unbind("mouseenter"),e("a.list-link").unbind("mouseleave"),e("a.plus-link, .menu-item a, a[data-fancybox]").unbind("mouseenter"),e("a.plus-link, .menu-item a, a[data-fancybox]").unbind("mouseleave"),e("a.splash-link").unbind("mouseenter"),e("a.splash-link").unbind("mouseleave"),e("button.plyr__control, .fancybox-button.fancybox-button--close").unbind("mouseenter"),e("button.plyr__control, .fancybox-button.fancybox-button--close").unbind("mouseleave"),e("a.fancybox-button--arrow_left").unbind("mouseenter"),e("a.fancybox-button--arrow_left").unbind("mouseleave"),e("a.fancybox-button--arrow_right").unbind("mouseenter"),e("a.fancybox-button--arrow_right").unbind("mouseleave"),1==isMobile||e("html").hasClass("touchevents")||(e(document).mouseleave(function(){y.addClass("is-out")}),e(document).mouseenter(function(){y.removeClass("is-out")}),e("iframe").mouseenter(function(){y.addClass("is-out")}),e("iframe").mouseleave(function(){y.removeClass("is-out")}),0!=e("a.plus-link:hover, .menu-item a:hover").length&&y.addClass("is-hovering plus"),e("a.plus-link, .menu-item a, a[data-fancybox]").mouseenter(function(){y.addClass("is-hovering plus")}),e("a.plus-link, .menu-item a, a[data-fancybox]").mouseleave(function(){y.removeClass(k)}),0!=e("a.splash-link:hover").length&&y.addClass("is-hovering arrow"),e("a.splash-link").mouseenter(function(){y.addClass("is-hovering arrow")}),e("a.splash-link").mouseleave(function(){y.removeClass(k)}),e("button.plyr__control, .fancybox-button.fancybox-button--close").mouseenter(function(){y.addClass("is-hovering")}),e("button.plyr__control, .fancybox-button.fancybox-button--close").mouseleave(function(){y.removeClass(k)}),e("a.fancybox-button--arrow_left").mouseenter(function(){y.addClass("is-hovering arrow-left")}),e("a.fancybox-button--arrow_left").mouseleave(function(){y.removeClass(k)}),e("a.fancybox-button--arrow_right").mouseenter(function(){y.addClass("is-hovering arrow-right")}),e("a.fancybox-button--arrow_right").mouseleave(function(){y.removeClass(k)}),0!=e("a.archive-link:hover").length&&y.addClass("is-hovering plus"),e("a.archive-link").mouseenter(function(t){y.addClass("is-hovering plus"),p=!0;var o=e(this).find("video");o.length&&o.get(0).play()}),e("a.archive-link").mouseleave(function(t){y.removeClass(k);var o=e(this),n=o.find("video");if(n.length&&1==p){p=!1;var a=o.find(".archive-thumbnail"),i=n.clone();i.prependTo(a),i.get(0).onloadeddata=function(){o.find("video:last-of-type").removeClass("video-transition"),o.find("video:last-of-type").fadeOut(750,function(){e(this).remove()})}}}),0!=e("a.list-link:hover").length&&y.addClass("is-hovering plus"),e("a.list-link").mouseenter(function(){y.addClass("is-hovering plus");var t=e(this).data("color"),o=e(this).data("text");e("#site-main").css("background-color",t),"black"==o&&e("html").addClass("text-to-black");var n=e(this).data("slug");e(".block--hover[data-slug='"+n+"']").each(function(){var t=e(this);t.addClass("is-active"),t.find("video").length&&(t.find("video").get(0).currentTime=0,setTimeout(function(){t.find("video").get(0).play()},250))})}),e("a.list-link").mouseleave(function(){if(e("body").hasClass(x)||e("body").hasClass("home")){e("#site-main").css("background-color",""),e("html").removeClass("text-to-black");var t=e(this).data("slug");console.log(t),e(".block--hover[data-slug='"+t+"']").each(function(){console.log("yes"),e(this).removeClass("is-active");var t=e(this);setTimeout(function(){e(this).hasClass("is-active")||t.find("video").length&&(t.find("video").get(0).pause(),t.find("video").get(0).currentTime=0)},250)})}y.removeClass(k)}))}function n(){if(e("body").hasClass("single")&&e(".single-bts-section").length){e(window).scrollTop()+e(window).height()/3>e(".single-bts-section").offset().top?(e("html").addClass("background-to-white"),e("html").addClass("bts-text-color")):(e("html").removeClass("background-to-white"),e("html").removeClass("bts-text-color"))}}function a(){g=!0,currentUrl=window.location.href.split("?")[0],currentUrl=currentUrl.split("#")[0],window.history.pushState({urlPath:currentUrl+x+"/"},"",currentUrl+x+"/"),document.title="Optical Arts | Features",e(".splash-page").addClass("is-hidden"),e(".barba-container").attr("data-namespace",x),y.removeClass(k),setTimeout(function(){r(),e(".splash-page").remove()},2e3)}function i(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function s(e){if(_[e.keyCode])return i(e),!1}function l(){window.addEventListener&&window.addEventListener("DOMMouseScroll",i,!1),document.addEventListener("wheel",i,{passive:!1}),window.onwheel=i,window.onmousewheel=document.onmousewheel=i,window.ontouchmove=i,document.onkeydown=s}function r(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",i,!1),document.removeEventListener("wheel",i,{passive:!1}),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null}function d(){if(e("body").hasClass("home")){g=!1,l(),e(document).on("click",".splash-link",function(e){e.preventDefault(),0==g&&a()}),e(".splash-page").on("DOMMouseScroll mousewheel wheel",function(e){(e.originalEvent.wheelDelta/120<0||e.originalEvent.deltaY>0)&&0==g&&a()});new Hammer(e(".splash-page").get(0)).on("pan swipe",function(e){0==g&&a()})}}function c(){var t=e(".splash-video video"),o=t.data("ratio"),n=e(window).innerHeight(),a=e(window).innerWidth(),i=a/n,s={x:0,y:0};if(i<o){t.css({height:"100%",width:"auto"});var l=n*o;s.x=Math.floor((l-a)/-2)+"px"}else if(i>=o){t.css({width:"100%",height:"auto"});var r=Math.ceil((a/o-n)/2);s.y=-r+"px"}t.css({"margin-left":s.x,"margin-right":s.x,"margin-top":s.y})}function u(){var t=e(".splash-video video"),o=e(".splash-video").data("desktop"),n=e(".splash-video").data("desktop-ratio"),a=e(".splash-video").data("mobile"),i=e(".splash-video").data("mobile-ratio");e(window).width()>e(window).height()?(t.append("<source type='video/mp4' src='"+o+"' />"),t.attr("data-ratio",n)):(t.append("<source type='video/mp4' src='"+a+"' />"),t.attr("data-ratio",i)),c()}function h(){if(e(window).width()<C&&1==isMobile){var t=window.innerHeight;e(".splash-page").css("height",t)}}function f(){e('[data-fancybox="gallery"]').fancybox({idleTime:0,animationEffect:"fade",loop:!0,transitionEffect:"slide",wheel:!0,buttons:["close"],btnTpl:{close:'<button data-fancybox-close class="fancybox-button fancybox-button--close">Close</button>',arrowLeft:'<a data-fancybox-prev class="fancybox-button fancybox-button--arrow_left"><div></div></a>',arrowRight:'<a data-fancybox-next class="fancybox-button fancybox-button--arrow_right"><div></div></a>'},afterLoad:function(){o()},beforeShow:function(){var t=e("#site-main").css("background-color");e(".fancybox-bg").css("background-color",t)},afterClose:function(){y.removeClass(k),o()},clickContent:function(e,t){return"image"===e.type&&"false"}})}function m(){e(".lazyVideo").each(function(){if(v(e(this))){var t=e(this);if(e(this).hasClass("pre-loaded"))t.find("video").get(0).play();else{var o=e(this).find("source").data("src");console.log(o),e(this).find("source").attr("src",o),e(this).find("video").get(0).load(),t.find("video").get(0).onloadeddata=function(){t.find("video").get(0).play()}}t.addClass("pre-loaded")}else e(this).find("video").get(0).pause()}),e(".archive-thumbnail").each(function(){if(v(e(this))&&e(this).find("video").length&&!e(this).find("video").hasClass("pre-loaded")){var t=e(this);t.find("video").get(0).load(),t.find("video").get(0).onloadeddata=function(){t.find("video").addClass("pre-loaded video-transition")}}});var t=e(window).height()/2,o=e(window).scrollTop(),n=e("[data-background]").map(function(){var t=e(this).offset().top;return t+(t+e(this).outerHeight())/2}).get();if(n.length){var a=n.reduce(function(e,n){return Math.abs(n-(o+t))<Math.abs(e-(o+t))?n:e}),i=n.indexOf(a),s=e("[data-background]").get(i),l=e(s).data("background");e("#site-main").css("background-color",l)}}function v(t){var o=e(window).scrollTop(),n=o+1.5*e(window).height(),a=e(t).offset().top,i=a+e(t).outerHeight();return a<=n&&i>=o}var b,g=!1,p=!1,w="",y=e("#site-cursor, #site-icon"),C=900,k="is-hovering arrow arrow-left arrow-right plus",x="features";e(document).ready(function(){1==isMobile&&(e("html").removeClass("desktop-device"),e("html").addClass("touch-device"))}),e(document).bind("mousemove",function(t){e("#site-cursor, #site-icon").css({left:t.clientX,top:t.clientY})});var _={37:1,38:1,39:1,40:1};e(document).ready(function(){d(),u(),o(),t(),h(),n(),f()}),e(window).resize(function(){c(),h()}),e(window).on("load",function(){o(),m()}),e(window).on("scroll",function(){m(),n()}),e(document).ready(function(){Barba.Dispatcher.on("linkClicked",function(e,t){});var t=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){var t=e(this.oldContainer);return e("html").addClass("is-loading"),new Promise(function(e,o){gsap.to(t,{duration:1.2,opacity:0,onComplete:function(){window.scrollTo(0,0),e()}})})},fadeIn:function(){function t(){gsap.to(n,{duration:1,opacity:1,onComplete:function(){o.done()}})}var o=this,n=e(this.newContainer);e(this.oldContainer).hide();var a=n.data("namespace"),i=n.data("color"),s=n.data("title"),l=n.data("text"),r=document.body.className;if(console.log(r),document.body.className="",e("body").addClass(a),e("html").removeClass("is-loading"),n.css({visibility:"visible",opacity:0}),"single"==a){e("#site-main").css("background",""+i),"black"==l?(e("html").addClass("text-to-black"),e("html").removeClass("bts-text-color")):e("html").removeClass("text-to-black bts-text-color"),e(".site-sidebar__title h1").text(s),"projects"==r?e(".site-sidebar__close a").attr("href",w+"/projects/"):"alphabet"==r?e(".site-sidebar__close a").attr("href",w+"/category/alphabet/"):e(".site-sidebar__close a").attr("href",w+"/"+x+"/"),e("#site-sidebar").removeClass("is-hidden");var d=e("#site-header").outerWidth();gsap.to("#site-main",{duration:1.6,ease:"power3.inOut",marginLeft:0,marginRight:d+"px",onComplete:function(){e("#site-header").addClass("is-hidden")}}),setTimeout(function(){t()},1200)}else if("projects"==a?e("#site-main").css("background",i):"alphabet"==a?e("#site-main").css("background",i):"journal"==a?e("#site-main").css("background",i):e("#site-main").css("background","black"),"black"==l?(e("html").addClass("text-to-black"),e("html").removeClass("background-to-white bts-text-color")):e("html").removeClass("text-to-black background-to-white bts-text-color"),"single"==r){e("#site-header").removeClass("is-hidden");var d=e("#site-header").outerWidth();gsap.to("#site-main",{duration:1.6,ease:"power3.inOut",marginLeft:d+"px",marginRight:0,onComplete:function(){e("#site-sidebar").addClass("is-hidden"),e("body").removeAttr("data-single")}}),setTimeout(function(){t()},1200)}else t()}});Barba.Pjax.getTransition=function(){return t},Barba.Pjax.start(),Barba.Prefetch.init(),Barba.Dispatcher.on("initStateChange",function(){"function"==typeof ga&&(ga("create","UA-105995010-17"),ga("send","pageview",location.pathname))}),Barba.Dispatcher.on("newPageReady",function(e,t,n,a){o(),u(),h(),f(),b.update()}),Barba.Dispatcher.on("transitionCompleted",function(){d(),o(),m()})})}(jQuery);
//# sourceMappingURL=app.min.js.map
